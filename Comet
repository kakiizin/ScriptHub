local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Comet",
    SubTitle = "",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local Tabs = {
    Auto = Window:AddTab({ Title = "Auto", Icon = "play" })
}

-- Variáveis de Controle
local Config = {
    AutoRifle = false,
    AutoJuzo = false
}

-- Serviços
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- Remotes (Chamadas Diretas)
local Events = ReplicatedStorage:WaitForChild("Events")
local GunManager = Events:WaitForChild("GunManager")
local gunFunctions = GunManager:WaitForChild("gunFunctions")
local skillRemote = Events:WaitForChild("Skill")
local takeStam = Events:WaitForChild("takestam")

-- Funções Auxiliares (Sem Varargs)
local function hasScriptInside(model)
    local descendants = model:GetDescendants()
    for i = 1, #descendants do
        local child = descendants[i]
        if child:IsA("Script") or child:IsA("LocalScript") or child:IsA("ModuleScript") then 
            return true 
        end
    end
    return false
end

local function getTarget()
    local closest = nil
    local dist = 500
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return nil end
    
    local rootPos = char.HumanoidRootPart.Position
    local workspaceDescendants = workspace:GetDescendants()
    
    for i = 1, #workspaceDescendants do
        local obj = workspaceDescendants[i]
        if obj:IsA("Humanoid") and obj.Parent and obj.Parent:IsA("Model") and obj.Health > 0 then
            local model = obj.Parent
            if not Players:GetPlayerFromCharacter(model) and model:FindFirstChild("Head") and hasScriptInside(model) then
                local d = (rootPos - model.Head.Position).Magnitude
                if d < dist then 
                    dist = d 
                    closest = model.Head 
                end
            end
        end
    end
    return closest
end

-- Função de Tween (Sem Varargs)
local function tweenTo(cframe, speed)
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end
    local hrp = char.HumanoidRootPart
    local distance = (hrp.Position - cframe.Position).Magnitude
    local duration = distance / speed
    
    local tween = TweenService:Create(hrp, TweenInfo.new(duration, Enum.EasingStyle.Linear), {CFrame = cframe})
    
    local dashLoop = task.spawn(function()
        while tween.PlaybackState == Enum.PlaybackState.Begin or tween.PlaybackState == Enum.PlaybackState.Playing do
            pcall(function()
                takeStam:FireServer(1, "dash")
            end)
            task.wait(0.2)
        end
    end)
    
    tween:Play()
    tween.Completed:Wait()
    task.cancel(dashLoop)
end

-- Loop Auto Rifle
task.spawn(function()
    while true do
        if Config.AutoRifle and not Config.AutoJuzo then
            local target = getTarget()
            if target then
                pcall(function()
                    gunFunctions:InvokeServer("reload", { Gun = "Rifle" })
                    task.wait(0.1)
                    GunManager:FireServer("fire", {
                        Start = CFrame.lookAt(player.Character.HumanoidRootPart.Position, target.Position),
                        Gun = "Rifle",
                        joe = "true",
                        Position = target.Position
                    })
                end)
            end
        end
        task.wait(0.3)
    end
end)

-- Loop Auto Juzo (Estrutura Estática e Segura)
task.spawn(function()
    while true do
        if Config.AutoJuzo then
            local char = player.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            
            if hrp then
                pcall(function()
                    -- 1. Posição 1
                    local pos1 = CFrame.new(1760.85242, 9.82812977, -10489.0752)
                    tweenTo(pos1, 100)
                    task.wait(0.2)

                    -- 2. Reload
                    gunFunctions:InvokeServer("reload", { Gun = "Rifle" })
                    task.wait(0.5)

                    -- 3. Sky Walk 2
                    skillRemote:InvokeServer("Sky Walk2", {
                        char = char,
                        cf = CFrame.new(1765.7352294921875, 17.062767028808594, -10489.6767578125, 0, 1, -0, 0, -0, -1, -1, 0, -0)
                    })
                    task.wait(0.3)

                    -- 4. Teleporte Posição 2
                    if char:FindFirstChild("HumanoidRootPart") then
                        char.HumanoidRootPart.CFrame = CFrame.new(1765.56335, 57.0781345, -10528.8643)
                    end
                    task.wait(0.2)

                    -- 5. Atirar
                    local target = getTarget()
                    if target and char:FindFirstChild("HumanoidRootPart") then
                        GunManager:FireServer("fire", {
                            Start = CFrame.lookAt(char.HumanoidRootPart.Position, target.Position),
                            Gun = "Rifle",
                            joe = "true",
                            Position = target.Position
                        })
                    end
                    task.wait(0.3)

                    -- 6. Sky Walk 2
                    skillRemote:InvokeServer("Sky Walk2", {
                        char = char,
                        cf = CFrame.new(1765.7352294921875, 17.062767028808594, -10489.6767578125, 0, 1, -0, 0, -0, -1, -1, 0, -0)
                    })
                    task.wait(0.2)

                    -- 7. Retorno Posição 1
                    if char:FindFirstChild("HumanoidRootPart") then
                        char.HumanoidRootPart.CFrame = CFrame.new(1760.85242, 9.82812977, -10489.0752)
                    end
                end)
            end
        end
        task.wait(0.2)
    end
end)

-- Interface
Tabs.Auto:AddToggle("AutoRifle", {
    Title = "Auto Rifle",
    Default = false,
    Callback = function(Value) Config.AutoRifle = Value end
})

Tabs.Auto:AddToggle("AutoJuzo", {
    Title = "Auto Juzo",
    Default = false,
    Callback = function(Value) Config.AutoJuzo = Value end
})

Window:SelectTab(1)
Fluent:Notify({ Title = "Comet", Content = "Script V10 (Static Mode) Carregado!", Duration = 5 })
